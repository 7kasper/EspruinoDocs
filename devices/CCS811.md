<!--- Copyright (c) 2018 Gordon Williams. See the file LICENSE for copying permission. -->
CCS811 Digital Air Quality Sensor
==================================

<span style="color:red">:warning: **Please view the correctly rendered version of this page at https://www.espruino.com/CCS811. Links, lists, videos, search, and other features will not work correctly when viewed on GitHub** :warning:</span>

* KEYWORDS: Module,I2C,CCS811,gas,TVOC,VOC,Volatile Organic Compounds,CO2,Carbon Dioxide,eCO2,sensor

[CCS811](https://ams.com/ccs811) is an [[I2C]] digital gas sensor for monitoring indoor air quality, which is handled with the [CCS811](/modules/CCS811.js) module.

Wiring Up
---------

The simplest way to use this sensor is connect power, SDA, SCL, and tie nWake pin to low.

| CCS811 pin    | Connection                   | Remark                                                                                                   |
|---------------|------------------------------|----------------------------------------------------------------------------------------------------------|
| #1 ADDR       | -                            | Sets the I2C address. low: 0x5A (default), high: 0x5B                                                    |
| #2 nRESET     | -                            | Active low, pulled up internally by the sensor, can be used to perform a hard-reset                      |
| #3 nINT       | optional GPIO                | It's pulled low by the CCS811 to indicate end of measurement or a set threshold value has been triggered |
| #4 - #5       | -                            | Pin 4 and 5 is probably already connected on the breakout board                                          |
| #6 VDD        | 1.8 - 3.3V                   |                                                                                                          |
| #7 nWAKE      | optional GPIO, or tie to low | Not relevant if running with 1 sec sample rate, can be used to reduce power usage of the CCS811          |
| #8 NC         | -                            | No connect                                                                                               |
| #9 SDA        | Espruino SDA                 |                                                                                                          |
| #10 SCL       | Espruino SCL                 |                                                                                                          |


How to use
-----------

```
I2C1.setup({scl:B6,sda:B7});
var gas = require("CCS811").connectI2C(I2C1);
// wait for the sensor to be ready
setTimeout(function() {
  gas.get(print);
}, 3000);
// prints { "eCO2": 491, "TVOC": 13, "new": true }
```

Or specify an interrupt pin to have data 'pushed' as soon as it is available:

```
var gas = require("CCS811").connectI2C(I2C1, {int : B8});
gas.on('data', print);
// prints { "eCO2": 491, "TVOC": 13, "new": true }
```

# Modes of Operation

The CCS811 has 5 modes of operation as follows

 -  Mode 0: Idle, low current mode
 -  Mode 1: Constant power mode, IAQ measurement every second
 -  Mode 2: Pulse heating mode IAQ measurement every 10 seconds
 -  Mode 3: Low power pulse heating mode IAQ measurement every 60 seconds
 -  Mode 4: Constant power mode, sensor measurement every 250ms

Mode 1 is the default. Mode 4 is for factory tests. Pass a `mode` parameter in the `options` object:

```
var gas = require("CCS811").connectI2C(I2C1, {int : B0, mode: 2}); // use interrupts and take measurements every 10 seconds
```

# Using nWake

You can save power by using lower sample rates, and utilising the nWake pin.
If you use 1 second sample rate, or don't care about power consumption, you can just tie the CCS811's nWake pin to GND and you are good to go.

Without nWake the sensor's power consumption between measurements is around 4.5mA @3.3V. Using the nWake pin it's standby current drops down to the uA range.

Using `B7` pin as nWake:
```
var gas = require("CCS811").connectI2C(I2C1, {int : B0, mode: 2, nWake: B7}); // use interrupts and take measurements every 10 seconds, using B7 as nWake
```

# Sensor firmware version

There is a firmware inside the sensor itself. The latest version at the time of writing is 2.0. Some boards may ship with an earlier version of the firmware. This module is compatible with 1.1 and 2.0 of the firmware.

To check the firmware version in the CCS811, just run the example program, and type `gas.r(0x24,2)` at the left hand side of the Espruino IDE. 0x24 is the firmware version register. If the response is `=new Uint8Array([17, 0])`, you have version 1.1 (17 = binary 0001 0001, the upper half of the first bit is the major, the lower half is the minor version).
If the response is `=new Uint8Array([32, 0])`, you have 2.0, and nothing to do!


Since updating the firmware is probably a one-off - and didn't want to reinvent the wheel - firmware update is not supported by this library. But successfully used this [Arduino example](https://github.com/maarten-pennings/CCS811/tree/master/examples/ccs811flash) to update. Just clone, and follow the instructions!

Reference
---------

* APPEND_JSDOC: CCS811.js

Buying
-----

CCS811 can be bought on breakout boards from several different sellers:

* [eBay](http://www.ebay.com/sch/i.html?_nkw=CCS811)
* [Pimoroni](https://shop.pimoroni.com/products/sparkfun-air-quality-breakout-ccs811)
* [Sparkfun](https://www.sparkfun.com/products/14193)
* [Adafruit](https://www.adafruit.com/product/3566)
